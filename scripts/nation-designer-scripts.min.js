function randomizeIdeas(){for(var e=[],a=0;10>a;a++){var t;do t=IdeasArray[Math.floor(Math.random()*IdeasArray.length)];while(-1!=e.indexOf(t));e.push(t),9==a&&(initComplete=!0),ideaSelects[a].val(t.name).change()}}function addSignToValues(e){return e>0?"+"+e:e}function getMaxIdeaLevel(e){return null!=e.cost4?4:null!=e.cost3?3:null!=e.cost2?2:1}function getFloatFromPercentage(e){return Math.round(100*parseFloat(e.replace("%","")))/100}function evaluateExcessIdeasInGroup(e,a){var t="If you have more than 50% of idea levels on a single group, those ideas cost more!";initComplete&&(e>50?($(a).css("background-color","#ffa8a8"),$(a).css("color","#000000"),$(a).attr("title",t),toastr.warning(t,"Over 50% on idea group")):($(a).css("background-color","#201913"),$(a).css("color","#f9f6da"),$(a).attr("title","")))}function evaluateExcessMultiplier(){var e=parseInt($("#total-idea-levels-adm").text()),a=parseInt($("#total-idea-levels-dip").text()),t=parseInt($("#total-idea-levels-mil").text()),l=Math.max(e,a,t)/(e+a+t);return l>.5?5*(l-.5):0}function updateAvailablePoints(){for(var e=0,a=0;10>a;a++)e+=parseFloat(costValues[a].val());$("#available-points-value").val(Math.floor($("#starting-points-input").val()-$("#reserved-points-input").val()-e)),$("#available-points-value").val()<0?($("#available-points-value").css("background-color","#ffa8a8"),toastr.error("You have spent more points than available","Negative Points")):$("#available-points-value").css("background-color","#f9f6da")}function updateIdeaGroupLevels(){for(var e=0,a=0,t=0,l=0,s=0;s<ideas.length;s++){var i=Math.floor(10*ideaCurrentLevels[s]/getMaxIdeaLevel(ideas[s]));"adm"==ideas[s].group?e+=i:"dip"==ideas[s].group?a+=i:"mil"==ideas[s].group&&(t+=i),l+=i}var o=Math.round(e/l*1e3)/10,r=Math.round(a/l*1e3)/10,n=Math.round(t/l*1e3)/10;$("#total-idea-levels-adm").text(o+"%"),$("#total-idea-levels-dip").text(r+"%"),$("#total-idea-levels-mil").text(n+"%"),evaluateExcessIdeasInGroup(o,"#total-idea-levels-adm"),evaluateExcessIdeasInGroup(r,"#total-idea-levels-dip"),evaluateExcessIdeasInGroup(n,"#total-idea-levels-mil")}function changeIdeaLevel(e,a){ideaCurrentLevels[e]=a,updateIdeaGroupLevels(),null!=ideas[e].valuePerLevel?isNaN(ideas[e].valuePerLevel)?modifierValues[e].val(addSignToValues(ideas[e].valuePerLevel)):modifierValues[e].val(addSignToValues(ideas[e].valuePerLevel*ideaCurrentLevels[e])):modifierValues[e].val(addSignToValues(ideas[e].percentagePerLevel*ideaCurrentLevels[e])+"%"),adjustIdeaCosts(),updateAvailablePoints()}function adjustIdeaCosts(){for(var e,a,t=evaluateExcessMultiplier(),l=0;10>l;l++){switch(ideaCurrentLevels[l]){case 1:e=ideas[l].cost1;break;case 2:e=ideas[l].cost2;break;case 3:e=ideas[l].cost3;break;case 4:e=ideas[l].cost4}a=e*costModifierByOrder[l]+e*t,costValues[l].val(Math.round(10*a)/10+" points")}}var imgPlaceholders=[],ideaSelects=[],costValues=[],modifierValues=[],levelButtons=[],ideas=[],ideaCurrentLevels=[],initComplete=!1;toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!0,onclick:null,showDuration:"200",hideDuration:"700",timeOut:"4000",extendedTimeOut:"300",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},jQuery(function(e){e("#accordion").accordion({collapsible:!0}),e(".ideaLvlRadioButtons").buttonset();for(var a=0;10>a;a++){imgPlaceholders.push(e("#img-placeholder-"+(a+1))),ideaSelects.push(e("#idea-"+(a+1)+"-selector")),modifierValues.push(e("#value-modifier-idea-"+(a+1))),costValues.push(e("#value-cost-idea-"+(a+1))),levelButtons.push([]);for(var t=1;4>=t;t++)levelButtons[a].push(e("#radio-idea-"+(a+1)+"-lv"+t));ideas.push(IdeasArray[0]),ideaCurrentLevels.push(1)}e("#points-selector").change(function(){e("#starting-points-input").val(e(this).val().substring(0,3)),updateAvailablePoints()}),e("#starting-points-input,#reserved-points-input").change(function(){updateAvailablePoints()}),e(".idea-row .ideaLvlRadioButtons input").change(function(){var e=this.id.split("-");changeIdeaLevel(e[2]-1,parseInt(e[3].replace("lv","")))}),e("[id^=idea-]").each(function(a,t){IdeasArray.forEach(function(e,t,l){"adm1"==e.id?ideaSelects[a].append('<optgroup class="select-group-label" label="Administrative">'):"dip1"==e.id?ideaSelects[a].append('<optgroup class="select-group-label" label="Diplomatic">'):"mil1"==e.id&&ideaSelects[a].append('<optgroup class="select-group-label" label="Military">');var s='<option val="'+e.id+'">'+e.name+"</option>";ideaSelects[a].append(s)}),ideaSelects[a].change(function(){var a=e(this).attr("id").split("-")[1]-1,t=e(this).find(":selected").attr("val"),l=IdeasArray.filter(function(e){return e.id==t});ideas[a]=l[0];for(var s=0;4>s;s++)null!=ideas[a]["cost"+(s+1)]?(levelButtons[a][s].button("enable"),levelButtons[a][s].css("color","#000000")):(levelButtons[a][s].button("disable"),levelButtons[a][s].css("color","#dddddd"));levelButtons[a][0].prop("checked",!0),levelButtons[a][0].button("refresh"),"adm"==ideas[a].group?imgPlaceholders[a].attr("src","img/adm-point-bg.png"):"dip"==ideas[a].group?imgPlaceholders[a].attr("src","img/dip-point-bg.png"):imgPlaceholders[a].attr("src","img/mil-point-bg.png"),changeIdeaLevel(a,parseInt(1))})}),e("#points-selector").change(),randomizeIdeas()});